# Drone Flight Predictor

Микросервис для предсказания полета БПЛА с использованием нейронной сети LSTM.

## Описание

Этот проект реализует микросервис, который может предсказать следующую точку траектории БПЛА на основе 5 предыдущих точек. Используется рекуррентная нейронная сеть LSTM для обучения на временных последовательностях.

## Особенности

- **FastAPI** для создания REST API
- **PyTorch LSTM** для предсказания траекторий
- **Docker** для контейнеризации
- **Pydantic** для валидации данных
- **Автоматическая нормализация** данных
- **Комплексные тесты** и метрики качества

## Структура проекта

```
├── app/                    # Основное приложение
│   ├── api/               # API эндпоинты
│   ├── core/              # Конфигурация и утилиты
│   ├── models/            # Модели PyTorch
│   └── schemas/           # Pydantic схемы
├── data/                  # Обработка данных
├── training/              # Обучение модели
├── tests/                 # Тесты
├── scripts/               # Скрипты оценки
└── configs/               # Конфигурационные файлы
```

## Создание окружения

# 1. Создать виртуальное окружение
python -m venv .venv

# 2. Активировать окружение
.venv\Scripts\Activate

# 3. Установить зависимости
pip install -r requirements.txt

## Быстрый старт

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Предобработка данных

```bash
python data/preprocess.py
```

### 3. Обучение модели

```bash
python training/train.py
```

### 4. Запуск сервиса

```bash
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

### 5. Использование Docker

```bash
docker-compose up --build
```

## API Endpoints

### POST /predict/

Предсказание следующей точки траектории.

**Запрос:**
```json
{
  "points": [
    {"x": 0.0, "y": 0.0, "z": 0.0, "t": 0.0},
    {"x": 1.0, "y": 1.0, "z": 1.0, "t": 1.0},
    {"x": 2.0, "y": 2.0, "z": 2.0, "t": 2.0},
    {"x": 3.0, "y": 3.0, "z": 3.0, "t": 3.0},
    {"x": 4.0, "y": 4.0, "z": 4.0, "t": 4.0}
  ]
}
```

**Ответ:**
```json
{
  "x": 5.1,
  "y": 5.2,
  "z": 5.0,
  "t": 5.0
}
```

### GET /predict/health

Проверка состояния сервиса.

**Ответ:**
```json
{
  "status": "healthy",
  "model_loaded": true
}
```

## Тестирование

```bash
# Запуск всех тестов
pytest tests/

# Тестирование модели
python tests/test_model.py

# Тестирование API
python tests/test_predict.py
```

## Оценка модели

```bash
python scripts/evaluate.py
```

## Конфигурация

Настройки модели и обучения находятся в:
- `configs/development.env` - переменные окружения
- `training/config.yaml` - параметры обучения

## Архитектура модели

- **Входные данные**: последовательность из 5 точек (x, y, z, t)
- **LSTM слои**: настраиваемое количество слоев и скрытых единиц
- **Выходные данные**: следующая точка траектории (x, y, z, t)

## Разработка

### Добавление новых данных

1. Поместите CSV файлы с данными в `data/raw/`
2. Обновите `data/preprocess.py` для загрузки ваших данных
3. Перезапустите предобработку

### Настройка модели

Измените параметры в `configs/development.env`:
- `HIDDEN_SIZE` - размер скрытого слоя LSTM
- `NUM_LAYERS` - количество слоев LSTM

### Мониторинг обучения

Графики обучения сохраняются в `training/training_history.png`.

## Производство

Для развертывания в production:

1. Используйте `configs/production.env`
2. Настройте внешнюю базу данных при необходимости
3. Добавьте мониторинг и логирование

## Лицензия

MIT License